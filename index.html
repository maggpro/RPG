<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMO RPG</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #2d2d2d;
        }
        #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.55.2/phaser.min.js"></script>
    <script src="src/scenes/CityScene.js"></script>
    <script src="src/scenes/ShopScene.js"></script>
    <script src="src/scenes/MainScene.js"></script>
</head>
<body>
    <div id="game-container"></div>
    <script>
        window.addEventListener('load', () => {
            const tg = window.Telegram.WebApp;
            tg.ready();
            tg.expand();

            const config = {
                type: Phaser.AUTO,
                parent: 'game-container',
                width: window.innerWidth,
                height: window.innerHeight,
                backgroundColor: '#87ceeb',
                scene: [CityScene, ShopScene, MainScene],
                scale: {
                    mode: Phaser.Scale.FIT,
                    autoCenter: Phaser.Scale.CENTER_BOTH
                },
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: { y: 0 },
                        debug: false
                    }
                }
            };

            let game;

            // Telegram API интеграция
            tg.MainButton.setText('Начать игру').show();
            tg.MainButton.onClick(() => {
                tg.MainButton.hide();
                if (!game) {
                    game = new Phaser.Game(config);
                }
            });

            // Полноэкранный режим
            tg.onEvent('fullscreenChanged', (isFullscreen) => {
                if (!isFullscreen) {
                    tg.requestFullscreen();
                }
            });

            // Обработка изменения размера окна
            window.addEventListener('resize', () => {
                if (game) {
                    game.scale.resize(window.innerWidth, window.innerHeight);
                }
            });
        });
    </script>
</body>
</html>